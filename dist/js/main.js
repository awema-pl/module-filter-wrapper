/**
 * Bundle of AWEMA filters
 * Generated: 2019-06-26 15:42:28
 * Version: 1.1.0
 */

!function(){"use strict";var e={reset:"page"},t={props:{reset:{type:String,default(){return this._config.reset}}},computed:{resetParams(){if(AWEMA.utils.object.isEmpty(this.reset))return{};{let e={};return this.reset.split(",").forEach(t=>{t=t.trim(),e[t]=""}),e}}},beforeCreate(){this._config=Object.assign(e,AWEMA.utils.object.get(AWEMA_CONFIG,"filterWrapper",{}))}};let r=0;var i={name:"filter-wrapper",mixins:[t],props:{name:{type:String,default:()=>"filter-"+r++},sendText:String,resetText:String,autoSubmit:Boolean},computed:{formBuilderExists(){return"form-builder"in this.$options.components},form(){return this.formBuilderExists&&this.$store.getters["forms/form"](this.name)},isActive(){if(!this.form)return!1;let e=!1,t=this.$route.query,r=this.form.fields;return Object.keys(r).forEach(i=>{let s,n=r[i];s=Array.isArray(n)?t.hasOwnProperty(i)&&!!t[i].length:t.hasOwnProperty(i)&&""!==t[i],e=e||s}),e}},watch:{isActive:{handler:function(e){this.formBuilderExists&&(this.$awemaFilters.commit("setFilterStatus",{name:this.name,status:e}),this.$emit("status-changed",e))},immediate:!0},"$route.query":{handler(e){this._isMounted?this.setDefaults():this.$nextTick(this.setDefaults)},immediate:!0}},methods:{applyFilter(e){let t=Object.assign({},this.$route.query,e,this.resetParams);this.$router.$setParam(t),this.$emit("applied",t)},resetFilter(){this.$root.$emit("forms:reset",this.name),this.$nextTick(this.$refs.formBuilder.send),this.$emit("reseted",this.$route.query)},setDefaults(){let e=this.$route.query;for(let t in this.form.fields)e.hasOwnProperty(t)&&e[t]!==this.form.fields[t]&&this.$store.commit("forms/setFieldValue",{formName:this.name,fieldName:t,value:e[t]})}},mounted(){this.formBuilderExists||console.error("filter-wrapper: you must include form-builder manually before using filter-wrapper")},beforeDestroy(){this.$awemaFilters.commit("deleteFilterInfo",{name:this.name})}};var s=function(e,t,r,i,s,n,o,a,u,l){"boolean"!=typeof o&&(u=a,a=o,o=!1);var f,d="function"==typeof r?r.options:r;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),i&&(d._scopeId=i),n?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},d._ssrRegister=f):t&&(f=o?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),f)if(d.functional){var c=d.render;d.render=function(e,t){return f.call(t),c(e,t)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,f):[f]}return r};const n=i;i.__file="filter-wrapper.vue";var o=s({render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.formBuilderExists?r("form-builder",{ref:"formBuilder",staticClass:"form-builder_filter",attrs:{url:"/",name:e.name,default:e.$route.query,"auto-submit":e.autoSubmit,sendText:e.sendText||e.$lang.FORM_APPLY,"disabled-dialog":""},on:{send:e.applyFilter},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("default",null,{fields:t.fields})]}}])},[r("template",{slot:"buttons-after"},[e._t("buttons-middle"),r("button",{staticClass:"btn btn_transparent form-builder__reset",attrs:{type:"reset"},on:{click:function(t){return t.preventDefault(),e.resetFilter(t)}}},[r("i",{staticClass:"icon icon-circle-cross"}),e._v("\n            "+e._s(e.resetText||e.$lang.FORM_RESET)+"\n        ")]),e._t("buttons-after")],2)],2):e._e()},staticRenderFns:[]},void 0,n,void 0,!1,void 0,void 0,void 0),a={name:"filter-builder",mixins:[t],props:{param:{type:Object,default:function(){return{}}},label:{type:String,required:!0},active:{type:Boolean,default:!1}},computed:{isActive(){let e=!0;for(let t in this.param)(""!==this.param[t]||""!==this.$route.query[t]&&void 0!==this.$route.query[t])&&this.$route.query[t]!==this.param[t]&&(e=!1);return e},query(){return Object.assign({},this.param,this.resetParams)},queryString(){return this.$route.path+"?"+AWEMA.utils.stringifyQuery(Object.assign({},this.$route.query,this.query))+this.$route.hash}},methods:{setActiveOnInit(){for(let e in this.param)if(this.$route.query.hasOwnProperty(e))return;this.$router.$setParam(this.param,!1)}},mounted(){this.active&&this.setActiveOnInit()}};const u=a;a.__file="filter-builder.vue";var l=s({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{staticClass:"btn awema-spa-ignore",class:{active:e.isActive},attrs:{href:e.queryString},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.$router.$setParam(e.query)}}},[e._v("\n    "+e._s(e.label)+"\n")])},staticRenderFns:[]},void 0,u,void 0,!1,void 0,void 0,void 0);var f={installed:!1,install:function(e){this.installed||(this.installed=!0,e.component("filter-wrapper",o),e.component("filter-builder",l))}};var d={state:()=>({active:{}}),mutations:{setFilterStatus(e,{name:t,status:r}){Vue.set(e.active,t,r)},deleteFilterInfo(e,t){Vue.delete(e.active,t)}}},c={FORM_APPLY:"Apply",FORM_RESET:"Reset"};const m={name:"filters",version:"1.1.0",install(e){Vue.prototype.$awemaFilters=new Vuex.Store(d),Vue.use(f),e.lang=c}},h="__awema_plugins_stack__";"AWEMA"in window?AWEMA.use(m):(window[h]=window[h]||[],window[h].push(m))}();
